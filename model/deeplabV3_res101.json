{
  "input_c": 3,
  "input_h": 640,
  "input_w": 640,
  "ENGPath": "H:/myGitHub/model/dpV3PP_res101.eng",
  "weightsDir": "H:/aliyun/wts_dpv3pp/",
  "int8": false,
  "fp16": true,
  "div_255": true,
  "Mean": [ 0.485, 0.456, 0.406 ],
  "Std": [ 0.229, 0.224, 0.225 ],
  "inputBlobName": "data",
  "outputBlobName": "output",
  "maxBatchsize": 1,
  "outputSize": 409600, //384000£¬65536
  "network": [
    {
      "layerStyle": "cba",
      "layerName": "conv_0",
      "inputName": "data",
      
      "convFile": "module.model.encoder.conv1",
      "parameter": {
        "input_c": 3,
        "output_c": 64,
        "kernel": [ 7, 7 ],
        "padding": [ 3, 3 ],
        "stride": [ 2, 2 ]
      },
      "bnFile": "module.model.encoder.bn1",
      "active_type": "relu"
    },
    {
      "layerStyle": "pool",
      "layerName": "maxpool_3",
      "inputName": "conv_0",
      "parameter": {
        "poolType": "kMAX",
        "kernel": [ 3, 3 ],
        "padding": [ 1, 1 ],
        "stride": [ 2, 2 ]
      }
    },
    {
      "layerStyle": "cba",
      "layerName": "conv_4",
      "inputName": "maxpool_3",
      "convFile": "module.model.encoder.layer1.0.conv1",
      "parameter": {
        "input_c": 64,
        "output_c": 64,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      },
      "bnFile": "module.model.encoder.layer1.0.bn1",
      "active_type": "relu"
    },
    {
      "layerStyle": "cba",
      "layerName": "conv_7",
      "inputName": "conv_4",
      "convFile": "module.model.encoder.layer1.0.conv2",
      "parameter": {
        "input_c": 64,
        "output_c": 64,
        "kernel": [ 3, 3 ],
        "padding": [ 1, 1 ],
        "stride": [ 1, 1 ]
      },
      "bnFile": "module.model.encoder.layer1.0.bn2",
      "active_type": "relu"
    },
    {
      "layerStyle": "cba",
      "layerName": "conv_10",
      "inputName": "conv_7",
      "convFile": "module.model.encoder.layer1.0.conv3",
      "parameter": {
        "input_c": 64,
        "output_c": 256,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      },
      "bnFile": "module.model.encoder.layer1.0.bn3"
    },
    {
      "layerStyle": "cba",
      "layerName": "conv_12",
      "inputName": "maxpool_3",
      "convFile": "module.model.encoder.layer1.0.downsample.0",
      "parameter": {
        "input_c": 64,
        "output_c": 256,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      },
      "bnFile": "module.model.encoder.layer1.0.downsample.1"
    },
    {
      "layerStyle": "eltwise",
      "layerName": "Add_14",
      "inputName": [ "conv_10", "conv_12" ],
      "eltType": "kSUM"
    },
    {
      "layerStyle": "active",
      "layerName": "relu_15",
      "active_type": "relu",
      "inputName": "Add_14"
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet1_1",
      "inputName": "relu_15",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer1.1",
      "parameter": {
        "input_c": 256,
        "temp_c": 64,
        "output_c": 256
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet1_2",
      "inputName": "resnet1_1",
      "downsample": false,
      
      "weightsFile": "module.model.encoder.layer1.2",
      "parameter": {
        "input_c": 256,
        "temp_c": 64,
        "output_c": 256
      }
    }, //resnet1_end
    {
      "layerStyle": "resnet3",
      "layerName": "resnet2_0",
      "inputName": "resnet1_2",
      "downsample": true,
      
      "weightsFile": "module.model.encoder.layer2.0",
      "parameter": {
        "input_c": 256,
        "temp_c": 128,
        "output_c": 512
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet2_1",
      "inputName": "resnet2_0",
      "downsample": false,
      
      "weightsFile": "module.model.encoder.layer2.1",
      "parameter": {
        "input_c": 512,
        "temp_c": 128,
        "output_c": 512
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet2_2",
      "inputName": "resnet2_1",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer2.2",
      "parameter": {
        "input_c": 512,
        "temp_c": 128,
        "output_c": 512
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet2_3",
      "inputName": "resnet2_2",
      "downsample": false,
     
      "weightsFile": "module.model.encoder.layer2.3",
      "parameter": {
        "input_c": 512,
        "temp_c": 128,
        "output_c": 512
      }
    }, //resnet2_end
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_0",
      "inputName": "resnet2_3",
      "downsample": true,
      "weightsFile": "module.model.encoder.layer3.0",
      "parameter": {
        "input_c": 512,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_1",
      "inputName": "resnet3_0",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.1",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_2",
      "inputName": "resnet3_1",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.2",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_3",
      "inputName": "resnet3_2",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.3",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_4",
      "inputName": "resnet3_3",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.4",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_5",
      "inputName": "resnet3_4",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.5",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_6",
      "inputName": "resnet3_5",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.6",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_7",
      "inputName": "resnet3_6",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.7",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_8",
      "inputName": "resnet3_7",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.8",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_9",
      "inputName": "resnet3_8",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.9",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_10",
      "inputName": "resnet3_9",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.10",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_11",
      "inputName": "resnet3_10",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.11",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_12",
      "inputName": "resnet3_11",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.12",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_13",
      "inputName": "resnet3_12",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.13",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_14",
      "inputName": "resnet3_13",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.14",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_15",
      "inputName": "resnet3_14",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.15",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_16",
      "inputName": "resnet3_15",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.16",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_17",
      "inputName": "resnet3_16",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.17",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_18",
      "inputName": "resnet3_17",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.18",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_19",
      "inputName": "resnet3_18",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.19",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_20",
      "inputName": "resnet3_19",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.20",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_21",
      "inputName": "resnet3_20",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.21",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    {
      "layerStyle": "resnet3",
      "layerName": "resnet3_22",
      "inputName": "resnet3_21",
      "downsample": false,
      "weightsFile": "module.model.encoder.layer3.22",
      "parameter": {
        "input_c": 1024,
        "temp_c": 256,
        "output_c": 1024
      }
    },
    //resnet3_end
    {
      "layerStyle": "resnet",
      "layerName": "resnet4_0",
      "inputName": "resnet3_22",
      "deep": 3,
      "downsample": true,
      "weightsFile": "module.model.encoder.layer4.0",
      "channel_all": [ 512, 512, 2048 ],
      "kernel_all": [ 1, 3, 1, 1 ],
      "padding_all": [ 0, 2, 0, 0 ],
      "stride_all": [ 1, 1, 1, 1 ],
      "dila_all": [ 2, 2, 2, 2 ],
      "downConv": "module.model.encoder.layer4.0.downsample.0",
      "downBn": "module.model.encoder.layer4.0.downsample.1",
      "active_type": "relu"
    },
    {
      "layerStyle": "resnet",
      "layerName": "resnet4_1",
      "inputName": "resnet4_0",
      "deep": 3,
      "downsample": false,
      "weightsFile": "module.model.encoder.layer4.1",
      "channel_all": [ 512, 512, 2048 ],
      "kernel_all": [ 1, 3, 1 ],
      "padding_all": [ 0, 2, 0 ],
      "stride_all": [ 1, 1, 1 ],
      "dila_all": [ 2, 2, 2 ],
      "active_type": "relu"
    },
    {
      "layerStyle": "resnet",
      "layerName": "resnet4_2",
      "inputName": "resnet4_1",
      "deep": 3,
      "downsample": false,
      
      "weightsFile": "module.model.encoder.layer4.2",
      "channel_all": [ 512, 512, 2048 ],
      "kernel_all": [ 1, 3, 1 ],
      "padding_all": [ 0, 2, 0 ],
      "stride_all": [ 1, 1, 1 ],
      "dila_all": [ 2, 2, 2 ],
      "active_type": "relu"
    }, //resnet4_end
    {
      "layerStyle": "cba",
      "layerName": "aspp0",
      "inputName": "resnet4_2",

      "convFile": "module.model.decoder.aspp.0.convs.0.0",
      "parameter": {
        "input_c": 2048,
        "output_c": 256,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      },
      "bnFile": "module.model.decoder.aspp.0.convs.0.1",
      "active_type": "relu"
    }, //aspp0
    {
      "layerStyle": "conv",
      "layerName": "aspp1_conv1",
      "inputName": "resnet4_2",
      "weightFile": "module.model.decoder.aspp.0.convs.1.0.0",
      "parameter": {
        "output_c": 2048,
        "kernel": [ 3, 3 ],
        "padding": [ 12, 12 ],
        "stride": [ 1, 1 ],
        "dilations": [ 12, 12 ],
        "groups": 2048
      }
    },
    {
      "layerStyle": "conv",
      "layerName": "aspp1_conv2",
      "inputName": "aspp1_conv1",
      "weightFile": "module.model.decoder.aspp.0.convs.1.0.1",
      "parameter": {
        "input_c": 2048,
        "output_c": 256,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      }
    },
    {
      "layerStyle": "bn",
      "layerName": "aspp1_bn",
      "inputName": "aspp1_conv2",
      "weightFile": "module.model.decoder.aspp.0.convs.1.1"
    },
    {
      "layerStyle": "active",
      "layerName": "aspp1_relu",
      "inputName": "aspp1_bn",
      "active_type": "relu"
    }, //aspp1
    {
      "layerStyle": "conv",
      "layerName": "aspp2_conv1",
      "inputName": "resnet4_2",
      "weightFile": "module.model.decoder.aspp.0.convs.2.0.0",
      "parameter": {
        "input_c": 2048,
        "output_c": 2048,
        "kernel": [ 3, 3 ],
        "padding": [ 24, 24 ],
        "stride": [ 1, 1 ],
        "dilations": [ 24, 24 ],
        "groups": 2048
      }
    },
    {
      "layerStyle": "conv",
      "layerName": "aspp2_conv2",
      "inputName": "aspp2_conv1",
      "weightFile": "module.model.decoder.aspp.0.convs.2.0.1",
      "parameter": {
        "input_c": 2048,
        "output_c": 256,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      }
    },
    {
      "layerStyle": "bn",
      "layerName": "aspp2_bn",
      "inputName": "aspp2_conv2",
      "weightFile": "module.model.decoder.aspp.0.convs.2.1"
    },
    {
      "layerStyle": "active",
      "layerName": "aspp2_relu",
      "inputName": "aspp2_bn",
      "active_type": "relu"
    }, //aspp2
    {
      "layerStyle": "conv",
      "layerName": "aspp3_conv1",
      "inputName": "resnet4_2",
      "weightFile": "module.model.decoder.aspp.0.convs.3.0.0",
      "parameter": {
        "input_c": 2048,
        "output_c": 2048,
        "kernel": [ 3, 3 ],
        "padding": [ 36, 36 ],
        "stride": [ 1, 1 ],
        "dilations": [ 36, 36 ],
        "groups": 2048
      }
    },
    {
      "layerStyle": "conv",
      "layerName": "aspp3_conv2",
      "inputName": "aspp3_conv1",
      "weightFile": "module.model.decoder.aspp.0.convs.3.0.1",
      "parameter": {
        "input_c": 2048,
        "output_c": 256,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      }
    },
    {
      "layerStyle": "bn",
      "layerName": "aspp3_bn",
      "inputName": "aspp3_conv2",
      "weightFile": "module.model.decoder.aspp.0.convs.3.1"
    },
    {
      "layerStyle": "active",
      "layerName": "aspp3_relu",
      "inputName": "aspp3_bn",
      "active_type": "relu"
    }, //aspp3
    {
      "layerStyle": "reduce",
      "layerName": "avgPool",
      "inputName": "resnet4_2",
      "keepD": true,
      "axes": 6
    },
    {
      "layerStyle": "cba",
      "layerName": "aspp4",
      "inputName": "avgPool",
      "convFile": "module.model.decoder.aspp.0.convs.4.1",
      "parameter": {
        "input_c": 2048,
        "output_c": 256,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      },
      "bnFile": "module.model.decoder.aspp.0.convs.4.2",
      "active_type": "relu"
    },
    {
      "layerStyle": "upsample_plugin",
      "layerName": "aspp4_up",
      "inputName": "aspp4",
      "grid": 40
    },
    {
      "layerStyle": "concat",
      "layerName": "aspp_cat",
      "axis": 0,
      "inputName": [ "aspp0", "aspp1_relu", "aspp2_relu", "aspp3_relu", "aspp4_up" ]
    },
    {
      "layerStyle": "cba",
      "layerName": "conv_381",
      "inputName": "aspp_cat",

      "convFile": "module.model.decoder.aspp.0.project.0",
      "parameter": {
        "input_c": 1280,
        "output_c": 256,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      },
      "bnFile": "module.model.decoder.aspp.0.project.1",
      "active_type": "relu"
    },
    {
      "layerStyle": "conv",
      "layerName": "conv_384",
      "inputName": "conv_381",
      "weightFile": "module.model.decoder.aspp.1.0",
      "parameter": {
        "input_c": 256,
        "output_c": 256,
        "kernel": [ 3, 3 ],
        "padding": [ 1, 1 ],
        "stride": [ 1, 1 ],
        "groups": 256
      }
    },
    {
      "layerStyle": "conv",
      "layerName": "conv_385",
      "inputName": "conv_384",
      "weightFile": "module.model.decoder.aspp.1.1",
      "parameter": {
        "input_c": 256,
        "output_c": 256,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      }
    },
    {
      "layerStyle": "bn",
      "layerName": "bn_386",
      "inputName": "conv_385",
      "weightFile": "module.model.decoder.aspp.2"
    },
    {
      "layerStyle": "active",
      "layerName": "relu_387",
      "inputName": "bn_386",
      "active_type": "relu"
    },
    {
      "layerStyle": "upsample",
      "layerName": "resize_389",

      "inputName": "relu_387",
      "mode": "bilinear",
      "grid": 160
    },
    {
      "layerStyle": "cba",
      "layerName": "res_aspp",

      "inputName": "resnet1_2",
      "convFile": "module.model.decoder.block1.0",
      "parameter": {
        "input_c": 256,
        "output_c": 48,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      },
      "bnFile": "module.model.decoder.block1.1",
      "active_type": "relu"
    },
    {
      "layerStyle": "concat",
      "layerName": "cat_393",

      "axis": 0,
      "inputName": [ "resize_389", "res_aspp" ]
    },
    {
      "layerStyle": "conv",
      "layerName": "conv_394",
      "inputName": "cat_393",
      "weightFile": "module.model.decoder.block2.0.0",
      "parameter": {
        "input_c": 304,
        "output_c": 304,
        "kernel": [ 3, 3 ],
        "padding": [ 1, 1 ],
        "stride": [ 1, 1 ],
        "groups": 304
      }
    },
    {
      "layerStyle": "conv",
      "layerName": "conv_395",
      "inputName": "conv_394",
      "weightFile": "module.model.decoder.block2.0.1",
      "parameter": {
        "input_c": 304,
        "output_c": 256,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      }
    },
    {
      "layerStyle": "bn",
      "layerName": "bn_396",
      "inputName": "conv_395",
      "weightFile": "module.model.decoder.block2.1"
    },
    {
      "layerStyle": "active",
      "layerName": "relu_397",
      "inputName": "bn_396",
      "active_type": "relu"
    },
    {
      "layerStyle": "conv",
      "layerName": "class",
      "inputName": "relu_397",
      "weightFile": "module.model.segmentation_head.0",
      "biasFile": "module.model.segmentation_head.0",

      "parameter": {
        "input_c": 256,
        "output_c": 10,
        "kernel": [ 1, 1 ],
        "padding": [ 0, 0 ],
        "stride": [ 1, 1 ]
      }
    },
    {
      "layerStyle": "upsample",
      "layerName": "cls_up",
      "inputName": "class",
      "mode": "linear",
      "grid": 640
    },
    {
      "layerStyle": "upsample",
      "layerName": "resize256",
      "inputName": "class",
      "mode": "nearest",
      "grid": 256
    },
    {
      "layerStyle": "topk",
      "layerName": "top_max",
      "inputName": "resize256",
      "outputName": "output",
      "TopKOperation": "kMAX",
      "k": 1,
      "reduceAxes": 1,
      "outputIndex": 1
    }

  ]
}
